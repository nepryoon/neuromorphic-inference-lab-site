<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Forecast Studio — Systems</title>
  <meta name="description" content="Forecast Studio: a time-series forecasting system with backtesting, feature pipelines, MLOps patterns, and deployment-ready outputs." />
  <link rel="icon" href="/favicon.svg" />
  <link rel="stylesheet" href="/style.css" />
</head>

<body>
  <header class="nav">
    <div class="inner">
      <div class="brand">
        <img src="/logo.svg" alt="Neuromorphic Inference Lab" />
        <span>Neuromorphic Inference Lab</span>
      </div>
      <nav class="navlinks" aria-label="Primary navigation">
        <a data-nav href="/">Signal</a>
        <a data-nav class="active" href="/demos/">Systems</a>
        <a data-nav href="/evidence/">Proof Ledger</a>
        <a data-nav href="/about/">Identity</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <p class="kicker">System</p>
      <h1 class="h1">Forecast Studio</h1>
      <p class="sub">
        Forecasting treated as engineering: reproducible data pipelines, backtesting harness, versioned artefacts, and deployment-ready outputs.
        Designed to evidence full-stack ML (Data → Model → Production).
      </p>

      <div class="badges">
        <span class="badge">Time-Series</span>
        <span class="badge">Feature Pipelines</span>
        <span class="badge">Backtesting</span>
        <span class="badge">Model Registry</span>
        <span class="badge">CI/CD for ML</span>
      </div>

      <div style="height:14px"></div>

      <div class="actions">
        <a class="btn primary" href="https://github.com/nepryoon/nil-forecast-studio" target="_blank" rel="noopener">Source repository</a>
        <a class="btn" href="/evidence/#forecast-studio">Proof ledger mapping</a>
        <a class="btn" href="/demos/">Back to Systems</a>
      </div>
    </section>

    <section class="section">
      <h2>What problem it solves</h2>
      <p class="lead">
        Many “forecasting projects” stop at a notebook. Forecast Studio makes forecasting operational:
        stable feature generation, defensible evaluation, and outputs that can be served or scheduled.
      </p>

      <div class="grid">
        <div class="card col-6">
          <h3>Business impact</h3>
          <ul class="clean">
            <li>Forecasts generated from a repeatable pipeline (no manual spreadsheet steps).</li>
            <li>Backtesting with consistent splits (prevents accidental leakage).</li>
            <li>Deployment-ready output format for downstream planning tools.</li>
          </ul>
        </div>

        <div class="card col-6">
          <h3>System architecture</h3>
          <ul class="clean">
            <li><strong>Ingest</strong>: batch data sources (CSV/DB extracts) → validated schema.</li>
            <li><strong>Transform</strong>: feature pipeline (lags, rolling stats, calendars).</li>
            <li><strong>Train</strong>: model selection + tuned baseline.</li>
            <li><strong>Evaluate</strong>: backtesting harness with metrics (MAE/RMSE/MAPE).</li>
            <li><strong>Publish</strong>: versioned artefacts + deployment output.</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>Interactive mini-demo (local, no backend)</h2>
      <p class="lead">
        This is a lightweight in-browser illustration: select a horizon and compare a baseline forecast to the last observed trend.
        It exists to show system thinking, not to replace the production pipeline.
      </p>

      <div class="card">
        <div class="demo">
          <div>
            <label class="small" for="h">Forecast horizon (steps)</label>
            <select id="h" class="select">
              <option value="6">6</option>
              <option value="12" selected>12</option>
              <option value="18">18</option>
            </select>

            <div style="height:12px"></div>

            <label class="small" for="mode">Baseline method</label>
            <select id="mode" class="select">
              <option value="naive" selected>Naïve (last value)</option>
              <option value="ma">Moving average (window=3)</option>
            </select>

            <div style="height:14px"></div>

            <div class="actions">
              <button id="run" class="btn primary" type="button">Run forecast</button>
              <button id="reset" class="btn" type="button">Reset</button>
            </div>

            <div style="height:14px"></div>
            <div class="panel">
              <div class="small">Output</div>
              <div id="out" style="margin-top:8px; line-height:1.6; color: rgba(234,240,255,.86);">
                Horizon: 12 · Baseline: Naïve · MAE (demo split): —
              </div>
            </div>
          </div>

          <div>
            <div class="panel">
              <div class="small">Series preview</div>
              <div style="height:10px"></div>
              <svg id="chart" viewBox="0 0 700 260" width="100%" height="260" role="img" aria-label="Time-series chart"></svg>
              <div class="small" style="margin-top:10px;">
                Solid = observed · Dashed = forecast (demo)
              </div>
            </div>
          </div>
        </div>

        <div style="height:12px"></div>

        <details>
          <summary class="small" style="cursor:pointer;">Demo data (generated)</summary>
          <pre id="dataDump"></pre>
        </details>
      </div>
    </section>

    <section class="section">
      <h2>Keywords (ATS trigger set)</h2>
      <div class="grid">
        <div class="card col-12">
          <div class="tags">
            <span class="tag">Time-Series Forecasting</span>
            <span class="tag">Feature Engineering</span>
            <span class="tag">Backtesting</span>
            <span class="tag">Data Validation</span>
            <span class="tag">CI/CD for ML</span>
            <span class="tag">Model Registry</span>
            <span class="tag">Artifact Versioning</span>
            <span class="tag">Monitoring-ready Outputs</span>
          </div>
          <p class="small">
            Evidence mapping lives in the Proof Ledger so each keyword remains clickable and verifiable.
          </p>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div>© <span id="year"></span> Neuromorphic Inference Lab</div>
      <div class="prov">
        <span id="build-branch">branch: …</span>
        <span id="build-commit">commit: …</span>
        <span id="build-time">built: …</span>
      </div>
    </footer>
  </main>

  <script>
    document.getElementById("year").textContent = String(new Date().getFullYear());

    // ---- Demo data (generated locally) ----
    // A synthetic monthly-ish series with trend + seasonality + small noise.
    const N = 42;
    const series = Array.from({length: N}, (_, i) => {
      const t = i;
      const trend = 0.55 * t;
      const season = 6 * Math.sin((2 * Math.PI * t) / 12);
      const noise = (Math.sin(t * 1.7) + Math.cos(t * 0.9)) * 0.9;
      return Math.round((80 + trend + season + noise) * 10) / 10;
    });

    const dump = document.getElementById("dataDump");
    dump.textContent = JSON.stringify(series, null, 2);

    const svg = document.getElementById("chart");

    function movingAverage(arr, w){
      const out = [];
      for(let i=0;i<arr.length;i++){
        const a = Math.max(0, i - w + 1);
        const slice = arr.slice(a, i+1);
        const m = slice.reduce((s,x)=>s+x,0) / slice.length;
        out.push(m);
      }
      return out;
    }

    function forecast(arr, horizon, mode){
      const last = arr[arr.length - 1];
      if(mode === "naive"){
        return Array.from({length: horizon}, ()=> last);
      }
      const ma = movingAverage(arr, 3);
      const v = ma[ma.length - 1];
      return Array.from({length: horizon}, ()=> Math.round(v * 10)/10);
    }

    function mae(yTrue, yPred){
      const n = Math.min(yTrue.length, yPred.length);
      let s = 0;
      for(let i=0;i<n;i++) s += Math.abs(yTrue[i] - yPred[i]);
      return n ? (s / n) : 0;
    }

    function renderChart(obs, pred){
      // Layout
      const W = 700, H = 260;
      const padL = 40, padR = 16, padT = 16, padB = 28;

      const all = obs.concat(pred);
      const min = Math.min(...all) - 3;
      const max = Math.max(...all) + 3;

      const xObs = (i) => padL + (i * (W - padL - padR)) / (obs.length + pred.length - 1);
      const xPred = (i) => xObs(obs.length - 1 + i);

      const y = (v) => padT + (H - padT - padB) * (1 - (v - min) / (max - min));

      const path = (pts) => pts.map((p, i) => `${i===0 ? "M" : "L"} ${p[0].toFixed(2)} ${p[1].toFixed(2)}`).join(" ");

      const obsPts = obs.map((v, i) => [xObs(i), y(v)]);
      const predPts = pred.map((v, i) => [xPred(i), y(v)]);

      const gridLines = 4;
      const grid = Array.from({length: gridLines + 1}, (_, i) => {
        const yy = padT + (i * (H - padT - padB)) / gridLines;
        return `<line x1="${padL}" y1="${yy}" x2="${W - padR}" y2="${yy}" stroke="rgba(255,255,255,.08)" />`;
      }).join("");

      const axis = `
        <line x1="${padL}" y1="${H-padB}" x2="${W-padR}" y2="${H-padB}" stroke="rgba(255,255,255,.14)" />
        <line x1="${padL}" y1="${padT}" x2="${padL}" y2="${H-padB}" stroke="rgba(255,255,255,.14)" />
      `;

      const obsPath = `<path d="${path(obsPts)}" fill="none" stroke="rgba(110,231,255,.90)" stroke-width="2.4" />`;
      const predPath = `<path d="${path([[obsPts[obsPts.length-1][0], obsPts[obsPts.length-1][1]]].concat(predPts))}"
        fill="none" stroke="rgba(167,139,250,.92)" stroke-width="2.4" stroke-dasharray="7 7" />`;

      const legend = `
        <g>
          <rect x="${padL}" y="${H-22}" width="12" height="3" fill="rgba(110,231,255,.90)"></rect>
          <text x="${padL+18}" y="${H-18}" fill="rgba(234,240,255,.75)" font-size="12">observed</text>
          <rect x="${padL+90}" y="${H-22}" width="12" height="3" fill="rgba(167,139,250,.92)"></rect>
          <text x="${padL+108}" y="${H-18}" fill="rgba(234,240,255,.75)" font-size="12">forecast</text>
        </g>
      `;

      svg.innerHTML = `
        <rect x="0" y="0" width="${W}" height="${H}" rx="14" ry="14" fill="rgba(255,255,255,.02)" />
        ${grid}
        ${axis}
        ${obsPath}
        ${predPath}
        ${legend}
      `;
    }

    function run(){
      const horizon = parseInt(document.getElementById("h").value, 10);
      const mode = document.getElementById("mode").value;

      // demo split: last 8 points as “test”
      const split = series.length - 8;
      const train = series.slice(0, split);
      const test = series.slice(split);

      const predTest = forecast(train, test.length, mode);
      const demoMae = mae(test, predTest);

      const pred = forecast(series, horizon, mode);

      renderChart(series, pred);

      const label = (mode === "naive") ? "Naïve" : "Moving average (3)";
      document.getElementById("out").textContent =
        `Horizon: ${horizon} · Baseline: ${label} · MAE (demo split): ${demoMae.toFixed(2)}`;
    }

    document.getElementById("run").addEventListener("click", run);
    document.getElementById("reset").addEventListener("click", () => {
      document.getElementById("h").value = "12";
      document.getElementById("mode").value = "naive";
      renderChart(series, []);
      document.getElementById("out").textContent =
        "Horizon: 12 · Baseline: Naïve · MAE (demo split): —";
    });

    // initial render
    renderChart(series, []);
  </script>

  <script src="/build-info.js"></script>
</body>
</html>
