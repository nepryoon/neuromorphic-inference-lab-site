<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MV Grid Fault Risk Scoring Platform — Projects</title>
  <meta name="description" content="End-to-end ML system: feature engineering, MLflow training, CI/CD for ML, FastAPI serving, Docker deployment, monitoring-ready outputs." />
  <link rel="icon" href="/favicon.svg" />
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <header class="nav">
    <div class="brand">
      <img src="/logo.svg" alt="Neuromorphic Inference Lab" />
      <span>Neuromorphic Inference Lab</span>
    </div>
    <nav class="navlinks" aria-label="Primary navigation">
      <a data-nav href="/">Home</a>
      <a data-nav href="/demos/">Projects</a>
      <a data-nav href="/evidence/">Evidence</a>
      <a data-nav href="/about/">About</a>
    </nav>
  </header>

  <main class="container">
    <section class="hero">
      <p class="kicker">Hero Project</p>
      <h1 class="h1">MV Grid Fault Risk Scoring Platform</h1>
      <p class="sub">
        Production-first ML system that predicts medium-voltage fault risk to prioritise preventive interventions.
        Demonstrates the full lifecycle: ingestion → feature engineering → training (MLflow) → Dockerised serving (FastAPI) → live inference endpoint.
      </p>
      <div class="badges">
        <span class="badge">Scalable ML Pipelines</span>
        <span class="badge">CI/CD for Model Deployment</span>
        <span class="badge">Inference Scaling</span>
        <span class="badge">Model Serving</span>
        <span class="badge">MLflow</span>
        <span class="badge">Dockerization</span>
      </div>
    </section>

    <section class="section">
      <div class="grid">
        <article class="card project col-6">
          <h3>Problem</h3>
          <p>
            Operational teams need a consistent way to identify high-risk assets/feeders early and allocate maintenance resources effectively.
            This reduces exposure to unplanned outages and supports preventive dispatch decisions.
          </p>

          <h3>Solution</h3>
          <p>
            A baseline risk scoring pipeline with time-aware split, reproducible training, and a serving endpoint returning
            probability plus an interpretable risk band (low/watch/high/critical).
          </p>

          <div class="tags">
            <span class="tag">Feature Engineering</span>
            <span class="tag">Time-based Split</span>
            <span class="tag">ROC-AUC / PR-AUC / F1</span>
            <span class="tag">Reproducible Builds</span>
          </div>

          <div class="actions">
            <a class="btn primary" href="https://mv-grid-fault-risk-api.onrender.com/docs" target="_blank" rel="noopener">Live API Docs</a>
            <a class="btn" href="https://mv-grid-fault-risk-api.onrender.com/health" target="_blank" rel="noopener">Health</a>
            <a class="btn" href="https://github.com/nepryoon/mv-grid-fault-risk" target="_blank" rel="noopener">Source Code</a>
          </div>
        </article>

        <article class="card project col-6">
          <h3>Architecture</h3>
          <p>
            <strong>Data</strong>: ingestion + validation → Parquet training table.<br />
            <strong>Model</strong>: baseline classifier tracked in MLflow (metrics + artefacts).<br />
            <strong>Serving</strong>: FastAPI `/predict` endpoint (Dockerised).<br />
            <strong>MLOps</strong>: CI training workflow, versioned artefacts, monitoring-ready outputs.
          </p>

          <h3>Live demo (calls the API)</h3>
          <p>Adjust the inputs and score fault risk via the live FastAPI endpoint.</p>

          <div class="card" style="padding:14px; border-radius:16px;">
            <form id="score-form">
              <div class="grid">
                <div class="col-6">
                  <label>Asset age (years)<br />
                    <input name="asset_age_years" type="number" step="0.5" value="15" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>
                <div class="col-6">
                  <label>Days since last fault<br />
                    <input name="days_since_last_fault" type="number" step="1" value="365" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>
                <div class="col-4">
                  <label>Faults last 30 days<br />
                    <input name="faults_last_30d" type="number" step="1" value="0" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>
                <div class="col-4">
                  <label>Faults last 90 days<br />
                    <input name="faults_last_90d" type="number" step="1" value="1" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>
                <div class="col-4">
                  <label>Faults last 180 days<br />
                    <input name="faults_last_180d" type="number" step="1" value="2" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>

                <div class="col-6">
                  <label>Asset type<br />
                    <select name="asset_type" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                      <option value="overhead" selected>overhead</option>
                      <option value="underground">underground</option>
                      <option value="substation">substation</option>
                      <option value="unknown">unknown</option>
                    </select>
                  </label>
                </div>

                <div class="col-6">
                  <label>Region<br />
                    <select name="region" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                      <option value="north" selected>north</option>
                      <option value="centre">centre</option>
                      <option value="south">south</option>
                      <option value="unknown">unknown</option>
                    </select>
                  </label>
                </div>

                <div class="col-6">
                  <label>Voltage (kV)<br />
                    <input name="voltage_kv" type="number" step="1" value="15" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>

                <div class="col-6">
                  <label>Manufacturer<br />
                    <input name="manufacturer" type="text" value="GenericGridCo" style="width:100%; padding:10px; border-radius:12px; border:1px solid #223046; background:#0b0f16; color:#e8edf6;">
                  </label>
                </div>

                <div class="col-12" style="margin-top:6px;">
                  <button class="btn primary" type="submit">Score risk</button>
                  <a class="btn" href="https://mv-grid-fault-risk-api.onrender.com/docs" target="_blank" rel="noopener">Open Swagger</a>
                </div>
              </div>
            </form>

            <div id="result" style="margin-top:12px; color:#a9b4c6;"></div>
          </div>
        </article>
      </div>
    </section>

    <section class="section">
      <h2>Key ATS keywords (intentionally explicit)</h2>
      <p>
        CI/CD for ML, model serving, inference scaling, MLflow tracking, feature engineering, statistical modelling,
        reproducible builds, time-based split, monitoring-ready outputs, automated retraining (design pattern).
      </p>
    </section>

    <footer class="footer">
      <div>© <span id="year"></span> Neuromorphic Inference Lab</div>
      <div class="prov">
        <span id="build-branch">branch: …</span>
        <span id="build-commit">commit: …</span>
        <span id="build-time">built: …</span>
      </div>
    </footer>
  </main>

  <script>
    document.getElementById("year").textContent = String(new Date().getFullYear());

    const API_PREDICT = "/api/mvgrid/predict";
    const API_HEALTH = "/api/mvgrid/health";


    function toNumber(v) {
      const n = Number(v);
      return Number.isFinite(n) ? n : v;
    }

    document.getElementById("score-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);

      const features = {};
      for (const [k, v] of data.entries()) {
      const vv = (typeof v === "string") ? v.trim() : v;
      features[k] = vv === "" ? null : toNumber(vv);
      }

      const resultEl = document.getElementById("result");
      resultEl.textContent = "Scoring… If this is the first request, the API may take ~30–60 seconds to warm up.";
      
      try { await fetch(API_HEALTH, { cache: "no-store" }); } catch (_) {}

      try {
          const res = await fetch(API_PREDICT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ features })
      });


        if (!res.ok) {
          const txt = await res.text();
          throw new Error("API error: " + txt);
        }

        const out = await res.json();
        resultEl.innerHTML = `
          <div class="prov">
            <span>fault probability (30d): <strong>${out.fault_probability_30d.toFixed(3)}</strong></span>
            <span>risk band: <strong>${String(out.risk_band).toUpperCase()}</strong></span>
            <span>model: ${out.model_source}</span>
          </div>
          <div style="margin-top:10px;">
            <small>Response is produced by a live FastAPI endpoint (Render) calling an MLflow-exported model artefact.</small>
          </div>
        `;
      } catch (err) {
        resultEl.textContent = "Request failed: " + err.message;
      }
    });
  </script>

  <script src="/build-info.js"></script>
</body>
</html>
